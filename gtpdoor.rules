alert udp any any -> any 2123 (msg:"GTPDoor Trigger Packet Request Observed (idkey)"; flow:stateless; content:"|01|"; offset:1; depth:1; content:"|72 1f 18 08|"; distance:15; within:4; fast_pattern; xbits:set, gtpdoor.request, track ip_pair, expire 10; threshold:type limit, track by_src, count 1, seconds 600; classtype:trojan-activity; reference:url, https://doubleagent.net/telecommunications/backdoor/gtp/2024/02/27/GTPDOOR-COVERT-TELCO-BACKDOOR; reference:url, https://github.com/sud0woodo/detect_gtpdoor; metadata:created_at 2024-03-05; priority:3; sid:1; rev:1;)

alert udp any 2123 -> any any (msg:"GTPDoor Trigger Packet Response Observed (idkey)"; flow:stateless; content:"|02|"; offset:1; depth:1; content:"|72 1f 18 08|"; distance:15; within:4; fast_pattern; xbits:isset, gtpdoor.request, track ip_pair, expire 10; threshold:type limit, track by_dst, count 1, seconds 600; classtype:trojan-activity; reference:url, https://doubleagent.net/telecommunications/backdoor/gtp/2024/02/27/GTPDOOR-COVERT-TELCO-BACKDOOR; reference:url, https://github.com/sud0woodo/detect_gtpdoor; metadata:created_at 2024-03-05; priority:1; sid:2; rev:1;)

alert udp any 2123 -> any any (msg:"Invalid GTP Response Packet Observed"; flow:stateless; content:"|00|"; depth:1; threshold:type limit, track by_dst, count 1, seconds 600; classtype:suspicious-unknown; reference:url, https://doubleagent.net/telecommunications/backdoor/gtp/2024/02/27/GTPDOOR-COVERT-TELCO-BACKDOOR#gtp-firewall; reference:url, https://github.com/sud0woodo/detect_gtpdoor; metadata:created_at 2024-03-05; priority:1; sid:3; rev:1;)
